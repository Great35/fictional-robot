<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Actions Section</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <link rel="stylesheet" href="/styles.css">
</head>
<body class="bg-gray-50">
    <div id="actionsSection" class="section p-4">
        <div id="actionsTable" class="bg-white rounded-xl shadow-md p-6 animate-card">
            <h2 class="text-lg font-bold text-gray-800 mb-4">Actions</h2>
            <p class="text-gray-600 mb-6">View your assigned tasks.</p>
            <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="border-b border-gray-200">
                            <th class="py-3 px-4 text-sm font-medium text-gray-500">Task</th>
                            <th class="py-3 px-4 text-sm font-medium text-gray-500">Due Date</th>
                            <th class="py-3 px-4 text-sm font-medium text-gray-500">Status</th>
                            <th class="py-3 px-4 text-sm font-medium text-gray-500">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="actionsTableBody">
                        <tr class="border-b border-gray-200 hover:bg-gray-50 transition-colors" data-task-id="1">
                            <td class="py-3 px-4 text-sm text-gray-800">Prepare Report</td>
                            <td class="py-3 px-4 text-sm text-gray-600">2025-10-08</td>
                            <td class="py-3 px-4"><span class="px-2 py-1 bg-yellow-50 text-yellow-500 text-xs rounded-full">In Progress</span></td>
                            <td class="py-3 px-4">
                                <button class="view-task-btn text-blue-500 hover:text-blue-600">
                                    <i data-feather="eye" class="w-4 h-4"></i>
                                </button>
                            </td>
                        </tr>
                        <tr class="border-b border-gray-200 hover:bg-gray-50 transition-colors" data-task-id="2">
                            <td class="py-3 px-4 text-sm text-gray-800">Review Documents</td>
                            <td class="py-3 px-4 text-sm text-gray-600">2025-10-07</td>
                            <td class="py-3 px-4"><span class="px-2 py-1 bg-red-50 text-red-500 text-xs rounded-full">Overdue</span></td>
                            <td class="py-3 px-4">
                                <button class="view-task-btn text-blue-500 hover:text-blue-600">
                                    <i data-feather="eye" class="w-4 h-4"></i>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- View Task Modal -->
        <div id="taskModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center transition-opacity duration-300 z-[999998]" style="display: none;">
            <div class="bg-white rounded-lg shadow-lg w-full max-w-[358px] sm:max-w-[410px] md:max-w-[461px] p-2 sm:p-3 transform transition-all duration-300 z-[999999]">
                <div class="flex items-center justify-between mb-1 sm:mb-2">
                    <h2 class="text-2xs sm:text-base font-bold text-gray-800" id="modalTitle">View Task</h2>
                    <button class="text-gray-500 hover:text-gray-700 text-lg sm:text-xl font-semibold" id="closeModal">&times;</button>
                </div>
                <div class="mb-1 sm:mb-2">
                    <form id="taskForm">
                        <div class="mb-1 sm:mb-2">
                            <label class="block text-2xs sm:text-xs font-medium text-gray-700 mb-0.5 sm:mb-1" for="taskName">Task Name</label>
                            <input type="text" id="taskName" class="w-full border border-gray-300 rounded-lg px-1.5 sm:px-2 py-0.5 sm:py-1 text-2xs sm:text-xs bg-gray-100 cursor-not-allowed" readonly>
                        </div>
                        <div class="mb-1 sm:mb-2">
                            <label class="block text-2xs sm:text-xs font-medium text-gray-700 mb-0.5 sm:mb-1" for="taskDueDate">Due Date</label>
                            <input type="date" id="taskDueDate" class="w-24 sm:w-32 border border-gray-300 rounded-lg px-1.5 sm:px-2 py-0.5 sm:py-1 text-2xs sm:text-xs bg-gray-100 cursor-not-allowed" readonly>
                        </div>
                        <div class="mb-1 sm:mb-2">
                            <label class="block text-2xs sm:text-xs font-medium text-gray-700 mb-0.5 sm:mb-1" for="taskStatus">Status</label>
                            <select id="taskStatus" class="w-full border border-gray-300 rounded-lg px-1.5 sm:px-2 py-0.5 sm:py-1 text-2xs sm:text-xs bg-gray-100 cursor-not-allowed" disabled>
                                <option value="In Progress">In Progress</option>
                                <option value="Overdue">Overdue</option>
                                <option value="Completed">Completed</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="flex justify-end">
                    <button type="button" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-0.5 sm:py-1 px-2 sm:px-3 rounded-lg transition-colors duration-200 text-2xs sm:text-xs" id="cancelModal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Feather icons
        feather.replace();

        // Modal and form elements
        const modal = document.getElementById('taskModal');
        const form = document.getElementById('taskForm');
        const nameInput = document.getElementById('taskName');
        const dueDateInput = document.getElementById('taskDueDate');
        const statusSelect = document.getElementById('taskStatus');

        // Mock task data
        const mockTasks = {
            1: { task: 'Prepare Report', dueDate: '2025-10-08', status: 'In Progress' },
            2: { task: 'Review Documents', dueDate: '2025-10-07', status: 'Overdue' }
        };

        // Refresh the actions table
        function refreshActionsSection() {
            const tableBody = document.getElementById('actionsTableBody');
            tableBody.innerHTML = Object.entries(mockTasks).map(([id, task]) => `
                <tr class="border-b border-gray-200 hover:bg-gray-50 transition-colors" data-task-id="${id}">
                    <td class="py-3 px-4 text-sm text-gray-800">${task.task}</td>
                    <td class="py-3 px-4 text-sm text-gray-600">${task.dueDate}</td>
                    <td class="py-3 px-4"><span class="px-2 py-1 text-xs rounded-full ${
                        task.status === 'Completed' ? 'bg-green-50 text-green-500' :
                        task.status === 'In Progress' ? 'bg-yellow-50 text-yellow-500' :
                        'bg-red-50 text-red-500'
                    }">${task.status}</span></td>
                    <td class="py-3 px-4">
                        <button class="view-task-btn text-blue-500 hover:text-blue-600">
                            <i data-feather="eye" class="w-4 h-4"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
            feather.replace();
        }

        // Open modal
        function openModal(taskId) {
            const task = mockTasks[taskId];
            if (!task) return;
            nameInput.value = task.task;
            dueDateInput.value = task.dueDate;
            statusSelect.value = task.status;
            document.getElementById('modalTitle').textContent = `View: ${task.task}`;
            modal.style.display = 'flex';
            setTimeout(() => modal.classList.add('show'), 10);
        }

        // Close modal
        function closeModal() {
            modal.classList.remove('show');
            setTimeout(() => modal.style.display = 'none', 300);
        }

        // Delegated events
        document.addEventListener('click', (e) => {
            if (e.target.closest('.view-task-btn')) {
                const row = e.target.closest('tr');
                const id = row.dataset.taskId;
                openModal(id);
            }
            if (e.target.closest('#closeModal') || e.target.closest('#cancelModal')) {
                closeModal();
            }
        });

        // Escape key to close modal
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && modal.style.display === 'flex') closeModal();
        });
    </script>
</body>
</html>